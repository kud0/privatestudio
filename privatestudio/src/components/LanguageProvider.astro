---
import { ui } from '../i18n/ui';
---

<script define:vars={{ ui }}>
  window.translations = ui;
  window.currentLang = localStorage.getItem('lang') || 'es';

  function updateText() {
    const lang = window.currentLang;
    document.querySelectorAll('[data-i18n]').forEach(el => {
      const key = el.getAttribute('data-i18n');
      if (window.translations[lang] && window.translations[lang][key]) {
        // Handle placeholders if needed, simpler for now
        if (el.tagName === 'INPUT' && el.getAttribute('placeholder')) {
             el.setAttribute('placeholder', window.translations[lang][key]);
        } else {
             el.innerText = window.translations[lang][key];
        }
      }
    });
    
    // Update active class on buttons if they exist
    document.querySelectorAll('.lang-btn').forEach(btn => {
        if (btn.getAttribute('data-lang') === lang) {
            btn.classList.add('text-white', 'font-bold');
            btn.classList.remove('text-gray-400');
        } else {
            btn.classList.remove('text-white', 'font-bold');
            btn.classList.add('text-gray-400');
        }
    });
  }

  window.setLanguage = (lang) => {
    window.currentLang = lang;
    localStorage.setItem('lang', lang);
    updateText();
  }

  document.addEventListener('DOMContentLoaded', updateText);
</script>